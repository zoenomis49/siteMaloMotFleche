<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mots Crois√©s Sp√©cial Malo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #0f0f23;
            color: #fff;
            min-height: 100vh;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .header {
            text-align: center;
            margin-bottom: 3rem;
        }
        
        .title {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }
        
        .subtitle {
            color: #8b8b8b;
            font-size: 1.1rem;
            margin-bottom: 2rem;
        }
        
        .controls {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 0.95rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            background: #1a1a2e;
            color: #fff;
            border: 1px solid #333;
        }
        
        .btn:hover {
            background: #2a2a3e;
            transform: translateY(-1px);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
        }
        
        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 2rem;
            align-items: start;
        }
        
        .grid-container {
            background: #1a1a2e;
            border-radius: 12px;
            padding: 2rem;
            border: 1px solid #333;
        }
        
        .grid-title {
            font-size: 1.5rem;
            font-weight: 600;
            text-align: center;
            margin-bottom: 2rem;
            color: #e0e0e0;
        }
        
        .crossword-grid {
            display: grid;
            grid-template-columns: repeat(13, 1fr);
            gap: 1px;
            background: #333;
            border: 2px solid #333;
            border-radius: 4px;
            padding: 2px;
            margin: 0 auto;
            max-width: 520px;
        }
        
        .cell {
            width: 38px;
            height: 38px;
            background: #fff;
            color: #000;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            font-weight: 600;
            position: relative;
            border: 1px solid #ddd;
        }
        
        .cell.black {
            background: #2a2a3e;
            color: #fff;
        }
        
        .cell-number {
            position: absolute;
            top: 1px;
            left: 2px;
            font-size: 10px;
            color: #666;
            font-weight: normal;
        }
        
        .definitions-panel {
            background: #1a1a2e;
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid #333;
            max-height: 600px;
            overflow-y: auto;
        }
        
        .definitions-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #e0e0e0;
            margin-bottom: 1rem;
            text-align: center;
        }
        
        .definitions-section {
            margin-bottom: 1.5rem;
        }
        
        .definitions-section h3 {
            color: #667eea;
            font-size: 1rem;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }
        
        .definition-item {
            display: flex;
            margin-bottom: 0.3rem;
            font-size: 0.85rem;
            line-height: 1.3;
        }
        
        .definition-number {
            color: #667eea;
            font-weight: 600;
            min-width: 25px;
        }
        
        .definition-text {
            color: #ccc;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 1rem;
            margin-top: 2rem;
            grid-column: 1 / -1;
        }
        
        .stat-card {
            background: #2a2a3e;
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #333;
        }
        
        .stat-number {
            font-size: 1.5rem;
            font-weight: 700;
            color: #667eea;
        }
        
        .stat-label {
            color: #8b8b8b;
            font-size: 0.8rem;
            margin-top: 0.5rem;
        }
        
        .loading {
            text-align: center;
            padding: 3rem;
            color: #8b8b8b;
            font-size: 1.1rem;
            grid-column: 1 / -1;
        }
        
        .spinner {
            border: 3px solid #333;
            border-left: 3px solid #667eea;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 1rem auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .footer {
            text-align: center;
            margin-top: 3rem;
            padding: 2rem;
            background: #1a1a2e;
            border-radius: 8px;
            color: #8b8b8b;
            border: 1px solid #333;
        }
        
        @media print {
            body {
                background: white;
                color: black;
            }
            
            .header .controls,
            .stats,
            .footer {
                display: none;
            }
            
            .main-content {
                display: block;
            }
            
            .grid-container {
                background: white;
                border: 2px solid #000;
                margin-bottom: 2rem;
            }
            
            .definitions-panel {
                background: white;
                border: 1px solid #000;
                page-break-inside: avoid;
            }
            
            .cell {
                border: 1px solid #000;
            }
            
            .cell.black {
                background: #000;
                color: white;
            }
            
            .definitions-title,
            .definitions-section h3 {
                color: #000;
            }
            
            .definition-text {
                color: #333;
            }
        }
        
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .title {
                font-size: 2rem;
            }
            
            .cell {
                width: 28px;
                height: 28px;
                font-size: 0.7rem;
            }
            
            .crossword-grid {
                max-width: 380px;
            }
            
            .cell-number {
                font-size: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">Mots Crois√©s Sp√©cial Malo</h1>
            <p class="subtitle">R√©f√©rences priv√©es entre amis - Format fran√ßais traditionnel</p>
            <div class="controls">
                <button class="btn btn-primary" onclick="generateGrid()">üéÆ G√©n√©rer une grille</button>
                <button class="btn" onclick="newGrid()">üîÑ Nouvelle grille</button>
                <button class="btn" onclick="printGrid()">üñ®Ô∏è Imprimer</button>
            </div>
        </div>
        
        <div class="main-content">
            <div class="grid-container">
                <h2 class="grid-title">Grille 13√ó13 - Mots Crois√©s</h2>
                <div id="crossword-grid" class="crossword-grid">
                    <div class="loading">
                        <div class="spinner"></div>
                        Cliquez sur "G√©n√©rer une grille" pour commencer !
                    </div>
                </div>
            </div>
            
            <div class="definitions-panel">
                <h3 class="definitions-title">D√©finitions</h3>
                <div id="definitions-content">
                    <div class="loading">
                        <p>Les d√©finitions appara√Ætront ici apr√®s g√©n√©ration de la grille.</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="stats">
            <div class="stat-card">
                <div class="stat-number" id="words-count">0</div>
                <div class="stat-label">Mots plac√©s</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">13√ó13</div>
                <div class="stat-label">Grille</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="coverage">0%</div>
                <div class="stat-label">Couverture</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="black-cells">0</div>
                <div class="stat-label">Cases noires</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="intersections">0</div>
                <div class="stat-label">Intersections</div>
            </div>
        </div>
        
        <div class="footer">
            <p>üíú Cr√©√© avec amour pour Malo et ses amis üíú</p>
            <p>Format fran√ßais traditionnel - R√©f√©rences priv√©es üòâ</p>
        </div>
    </div>

    <script>
        const wordDatabase = {
            "MALO": "destinataire de cette grille",
            "THOMAS": "n√© en juillet",
            "LORIS": "r√™ve de laura",
            "GASPARD": "sans soeur",
            "KIERAN": "refuse la cocaine",
            "SAMUEL": "employ√© de marandon",
            "REMI": "amateur de pastis",
            "ARTHUR": "lardiere en slip",
            "LILI": "orifice incongru",
            "ANAIS": "autre orifice",
            "ZOE": "ex du flex",
            "LAURA": "r√™ve de loris",
            "EVE": "premi√®re femme",
            "SARAH": "loris la r√™ve aussi",
            "LEA": "rousse en paire",
            "STEPHANIE": "propri√©taire de jacuzzi",
            "CASSANDRE": "presque stephane",
            "NAOMIE": "regarde westworld",
            "JEANNE": "apr√®s lorie",
            "CHAT": "animal domestique",
            "SLIP": "arthur le porte",
            "METRO": "fofolle y est debout",
            "PHOTO": "caca matinal",
            "BIERE": "avec transat",
            "CRIME": "salit esplanade",
            "TERRE": "google earth",
            "FILLES": "kayak nocturne",
            "TRIO": "trois suisses",
            "PASTIS": "breuvage de remi",
            "JUILLET": "mois de thomas",
            "PERMIS": "echecs de zoe",
            "JACUZZI": "chez stephanie",
            "COCAINE": "kieran refuse",
            "CAMPING": "nom isco",
            "GOOGLE": "earth amaia",
            "TRANSAT": "avec biere",
            "FOFOLLE": "debout metro",
            "KAYAK": "activite nocturne",
            "OMEGLE": "arthur slip",
            "ISCO": "nom de camping",
            "CRACK": "arthur en slip",
            "COLIN": "autre fils",
            "LORIE": "avant jeanne",
            "LEAN": "breuvage honteux",
            "TENTE": "remplacement",
            "VACHE": "morte en vingt-quatre",
            "CACA": "photo camping",
            "CLOPE": "transat biere",
            "GOUT": "vanille isautier",
            "TETE": "luciole plate",
            "ALCOOL": "lieu irlandais",
            "AMOUR": "jul estival",
            "PAIN": "matheflon couteau",
            "MEME": "prenom anita",
            "FROID": "teo kfc",
            "LAMPE": "horloge cassandre",
            "DEALER": "pmu plante",
            "MOOD": "sunshine entre",
            "SQUARE": "herissons nombreux",
            "CRIME": "esplanade salie",
            "REFLET": "laity intime",
            "CHIFFRE": "bus avec",
            "BEBES": "bus rempli",
            "PSEUDO": "carreaux instagram",
            "MALHEUR": "zebiblux porte",
            "AMATEUR": "remi pastis",
            "EMPLOYE": "samuel marandon",
            "REGARDE": "naomie westworld",
            "TOURNANTE": "lubin concurrent",
            "DEBOUT": "fofolle metro",
            "MATINAL": "caca photo",
            "INTIME": "laity reflet",
            "REMPLI": "bus bebes",
            "NOCTURNE": "kayak filles",
            "DEDANS": "mcfly duo",
            "PORTE": "zebiblux malheur"
        };

        let currentGrid = null;

        class CrosswordGenerator {
            constructor() {
                this.size = 13;
                this.grid = Array(this.size).fill().map(() => Array(this.size).fill(null));
                this.words = [];
                this.definitionsHorizontal = [];
                this.definitionsVertical = [];
                this.placedWords = new Set();
                this.wordNumbers = new Map();
                this.currentNumber = 1;
            }

            // Cr√©er un pattern de cases noires sym√©triques
            createBlackPattern() {
                const pattern = [
                    [0,0,0,1,0,0,0,0,0,1,0,0,0],
                    [0,0,0,0,0,0,1,0,0,0,0,0,0],
                    [0,0,0,0,0,0,0,0,0,0,0,0,0],
                    [1,0,0,0,1,0,0,0,1,0,0,0,1],
                    [0,0,0,1,0,0,0,0,0,1,0,0,0],
                    [0,0,0,0,0,0,1,0,0,0,0,0,0],
                    [0,1,0,0,0,1,0,1,0,0,0,1,0],
                    [0,0,0,0,0,0,1,0,0,0,0,0,0],
                    [0,0,0,1,0,0,0,0,0,1,0,0,0],
                    [1,0,0,0,1,0,0,0,1,0,0,0,1],
                    [0,0,0,0,0,0,0,0,0,0,0,0,0],
                    [0,0,0,0,0,0,1,0,0,0,0,0,0],
                    [0,0,0,1,0,0,0,0,0,1,0,0,0]
                ];
                
                for (let row = 0; row < this.size; row++) {
                    for (let col = 0; col < this.size; col++) {
                        if (pattern[row][col] === 1) {
                            this.grid[row][col] = { type: 'black' };
                        }
                    }
                }
            }

            // Trouver tous les emplacements de mots
            findWordSlots() {
                const slots = [];
                
                // Horizontaux
                for (let row = 0; row < this.size; row++) {
                    let start = -1;
                    for (let col = 0; col <= this.size; col++) {
                        const isBlack = col >= this.size || (this.grid[row][col] && this.grid[row][col].type === 'black');
                        
                        if (!isBlack && start === -1) {
                            start = col;
                        } else if (isBlack && start !== -1) {
                            const length = col - start;
                            if (length >= 3) {
                                slots.push({
                                    row: row,
                                    col: start,
                                    length: length,
                                    direction: 'horizontal'
                                });
                            }
                            start = -1;
                        }
                    }
                }
                
                // Verticaux
                for (let col = 0; col < this.size; col++) {
                    let start = -1;
                    for (let row = 0; row <= this.size; row++) {
                        const isBlack = row >= this.size || (this.grid[row][col] && this.grid[row][col].type === 'black');
                        
                        if (!isBlack && start === -1) {
                            start = row;
                        } else if (isBlack && start !== -1) {
                            const length = row - start;
                            if (length >= 3) {
                                slots.push({
                                    row: start,
                                    col: col,
                                    length: length,
                                    direction: 'vertical'
                                });
                            }
                            start = -1;
                        }
                    }
                }
                
                return slots;
            }

            // V√©rifier si un mot peut √™tre plac√© dans un slot
            canPlaceWordInSlot(word, slot) {
                if (word.length !== slot.length) return false;
                if (this.placedWords.has(word)) return false;
                
                for (let i = 0; i < word.length; i++) {
                    const row = slot.direction === 'horizontal' ? slot.row : slot.row + i;
                    const col = slot.direction === 'horizontal' ? slot.col + i : slot.col;
                    
                    const cell = this.grid[row][col];
                    if (cell && cell !== word[i] && typeof cell === 'string') {
                        return false;
                    }
                }
                
                return true;
            }

            // Calculer le score d'intersection pour un placement
            calculateIntersectionScore(word, slot) {
                let score = 0;
                
                for (let i = 0; i < word.length; i++) {
                    const row = slot.direction === 'horizontal' ? slot.row : slot.row + i;
                    const col = slot.direction === 'horizontal' ? slot.col + i : slot.col;
                    
                    const cell = this.grid[row][col];
                    if (cell === word[i]) {
                        score += 10; // Bonus pour intersection
                    }
                }
                
                return score;
            }

            // Placer un mot dans la grille
            placeWord(word, slot, definition) {
                for (let i = 0; i < word.length; i++) {
                    const row = slot.direction === 'horizontal' ? slot.row : slot.row + i;
                    const col = slot.direction === 'horizontal' ? slot.col + i : slot.col;
                    this.grid[row][col] = word[i];
                }
                
                this.words.push({
                    word: word,
                    row: slot.row,
                    col: slot.col,
                    direction: slot.direction,
                    number: this.currentNumber,
                    definition: definition
                });
                
                this.wordNumbers.set(`${slot.row}-${slot.col}`, this.currentNumber);
                this.currentNumber++;
                this.placedWords.add(word);
                
                if (slot.direction === 'horizontal') {
                    this.definitionsHorizontal.push({
                        number: this.currentNumber - 1,
                        definition: definition
                    });
                } else {
                    this.definitionsVertical.push({
                        number: this.currentNumber - 1,
                        definition: definition
                    });
                }
            }

            generate() {
                // Cr√©er le pattern de cases noires
                this.createBlackPattern();
                
                // Trouver tous les slots disponibles
                const slots = this.findWordSlots();
                
                // Trier les mots par longueur (plus longs d'abord)
                const words = Object.keys(wordDatabase)
                    .filter(word => word.length >= 3 && word.length <= 13)
                    .sort((a, b) => b.length - a.length);
                
                // Placer les mots
                let placedCount = 0;
                const maxPlacements = Math.min(slots.length, words.length);
                
                for (let attempt = 0; attempt < maxPlacements * 3 && placedCount < maxPlacements; attempt++) {
                    const word = words[Math.floor(Math.random() * words.length)];
                    const definition = wordDatabase[word];
                    
                    if (this.placedWords.has(word)) continue;
                    
                    // Trouver les slots compatibles
                    const compatibleSlots = slots.filter(slot => this.canPlaceWordInSlot(word, slot));
                    
                    if (compatibleSlots.length > 0) {
                        // Trier par score d'intersection
                        compatibleSlots.sort((a, b) => 
                            this.calculateIntersectionScore(word, b) - this.calculateIntersectionScore(word, a)
                        );
                        
                        const selectedSlot = compatibleSlots[0];
                        this.placeWord(word, selectedSlot, definition);
                        placedCount++;
                        
                        // Retirer le slot utilis√©
                        const slotIndex = slots.indexOf(selectedSlot);
                        if (slotIndex > -1) {
                            slots.splice(slotIndex, 1);
                        }
                    }
                }
                
                // Compter les cases noires
                let blackCells = 0;
                let intersections = 0;
                for (let row = 0; row < this.size; row++) {
                    for (let col = 0; col < this.size; col++) {
                        if (this.grid[row][col] && this.grid[row][col].type === 'black') {
                            blackCells++;
                        } else if (typeof this.grid[row][col] === 'string') {
                            intersections++;
                        }
                    }
                }
                
                return {
                    grid: this.grid,
                    words: this.words,
                    wordNumbers: this.wordNumbers,
                    definitionsHorizontal: this.definitionsHorizontal,
                    definitionsVertical: this.definitionsVertical,
                    placedCount: placedCount,
                    blackCells: blackCells,
                    intersections: intersections
                };
            }
        }

        function generateGrid() {
            const gridContainer = document.getElementById('crossword-grid');
            const definitionsContainer = document.getElementById('definitions-content');
            
            gridContainer.innerHTML = '<div class="loading"><div class="spinner"></div>G√©n√©ration en cours...</div>';
            definitionsContainer.innerHTML = '<div class="loading"><p>G√©n√©ration des d√©finitions...</p></div>';
            
            setTimeout(() => {
                const generator = new CrosswordGenerator();
                currentGrid = generator.generate();
                displayGrid();
                displayDefinitions();
                updateStats();
            }, 100);
        }

        function displayGrid() {
            const gridContainer = document.getElementById('crossword-grid');
            gridContainer.innerHTML = '';
            
            for (let row = 0; row < 13; row++) {
                for (let col = 0; col < 13; col++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    
                    const cellData = currentGrid.grid[row][col];
                    
                    if (cellData && cellData.type === 'black') {
                        cell.classList.add('black');
                    } else if (typeof cellData === 'string') {
                        cell.textContent = cellData;
                        
                        // Ajouter le num√©ro si c'est le d√©but d'un mot
                        const number = currentGrid.wordNumbers.get(`${row}-${col}`);
                        if (number) {
                            const numberSpan = document.createElement('span');
                            numberSpan.className = 'cell-number';
                            numberSpan.textContent = number;
                            cell.appendChild(numberSpan);
                        }
                    } else {
                        cell.classList.add('black');
                    }
                    
                    gridContainer.appendChild(cell);
                }
            }
        }

        function displayDefinitions() {
            const container = document.getElementById('definitions-content');
            
            let html = '';
            
            if (currentGrid.definitionsHorizontal.length > 0) {
                html += '<div class="definitions-section">';
                html += '<h3>Horizontalement</h3>';
                currentGrid.definitionsHorizontal
                    .sort((a, b) => a.number - b.number)
                    .forEach(def => {
                        html += `<div class="definition-item">
                            <span class="definition-number">${def.number}.</span>
                            <span class="definition-text">${def.definition}</span>
                        </div>`;
                    });
                html += '</div>';
            }
            
            if (currentGrid.definitionsVertical.length > 0) {
                html += '<div class="definitions-section">';
                html += '<h3>Verticalement</h3>';
                currentGrid.definitionsVertical
                    .sort((a, b) => a.number - b.number)
                    .forEach(def => {
                        html += `<div class="definition-item">
                            <span class="definition-number">${def.number}.</span>
                            <span class="definition-text">${def.definition}</span>
                        </div>`;
                    });
                html += '</div>';
            }
            
            container.innerHTML = html || '<p style="color: #8b8b8b;">Aucune d√©finition g√©n√©r√©e</p>';
        }

        function updateStats() {
            const placedCount = currentGrid ? currentGrid.placedCount : 0;
            const blackCells = currentGrid ? currentGrid.blackCells : 0;
            const intersections = currentGrid ? currentGrid.intersections : 0;
            const coverage = Math.round((intersections / (13 * 13 - blackCells)) * 100);
            
            document.getElementById('words-count').textContent = placedCount;
            document.getElementById('coverage').textContent = coverage + '%';
            document.getElementById('black-cells').textContent = blackCells;
            document.getElementById('intersections').textContent = intersections;
        }

        function newGrid() {
            generateGrid();
        }

        function printGrid() {
            if (!currentGrid) {
                alert('Veuillez d\'abord g√©n√©rer une grille !');
                return;
            }
            window.print();
        }

        document.addEventListener('DOMContentLoaded', function() {
            generateGrid();
        });
    </script>
</body>
</html>